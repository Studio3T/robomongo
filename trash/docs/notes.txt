Originally written for r2.2.0 revision.
Now updating to r2.4.0-rc0 revision